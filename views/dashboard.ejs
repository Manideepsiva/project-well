<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MY WEBSITE</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            position: relative; 
            min-height: 100vh; 
            background-image: url("bg.jpeg");
            background-size: cover; 
            background-position: center; 
            background-repeat: no-repeat; 
        }
        

        
        .header {
            background-color:darkturquoise;
            color: #fff;
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo {
            text-decoration: none;
            color: white;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
        }

        .logo img {
            width: 40px; 
            margin-right: 10px;
        }

        .navbar {
            display: flex;
        }

        .navbar a {
          text-decoration: none;
          color:#333;
  
          margin-right: 20px;
          position: relative;
          left:90%;
        }
        .search-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%); 
            display: flex;
            align-items: center;
        }
        .input-wrapper {
            position :relative;
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .input-field {
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
            width: 300px;
            margin-right: 13px;
        }
        .input-wrapper i {
            margin-right: 5px;
        }
        .button {
            padding: 10px;
            border-radius: 5px;
            background-color: #333;
            color: white;
            border: none;
            cursor: pointer;
        }
        .button:hover {
            background-color: aqua;
        }
        .treatment-search {
            display: none;
        }
        
        .footer {
            background-color: #333;
            color: #fff;
            padding: 0px;
            text-align: center;
            position: absolute;
            bottom: 0;
            width: 100%;
        }

        .footer-container {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            max-width: 1200px;
            margin: 0 auto;
        }

        .footer-box {
            flex: 1 1 100px;
            margin: 0 10px;
        }

        .footer-box h3 {
            color:#fff;
            margin-bottom: 10px;
            font-size: 2.0rem;
            
            padding: 1rem 0;
        }

        .footer-box a {
            display: block;
            color: #fff;
            text-decoration: none;
            margin-bottom: 0px;
        }

        .footer-box a:hover {
            text-decoration: underline;
        }

        .footer .credit span{
    color:var(--green);
}
.footer .credit{
    padding: 1rem;
    padding-top: 2rem;
    margin-top: 2rem;
    text-align: center;
    font-size: 2rem;
    color:var(--light-color);
    border-top: .1rem solid rgba(0, 0, 0, .1);
}
        .footer-navigation {
            margin-top: 20px;
        }

        .footer-navigation button {
            background-color: aqua;
            color:#fff;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
            margin: 0 5px;
        }

    .suggestions{
            position: absolute;
            top:100%;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
            background-color: aliceblue;
            width: 300px;
            z-index: 2000;
           
            display:none;

    }

    .suggestion {
  padding: 10px;
  cursor: pointer;
}

.suggestion:hover {
  background-color: #ddd;
}

.feedbackloc{
    display: none;
}

.searchresults{
    display : none;
}
.feedbacktreat{
    display: none;
}


table{
    width: 100%;
    border: 1px solid black;
    border-collapse: collapse;

  
}

th,td{
    border: 1px solid black;
}

.paignation{
    margin-left: 45%;
        
    }
    .paignation button{
     display: inline-block;

     
     
    }

    .paignation button:hover{
        background-color: seagreen;
        cursor: pointer;
    }

   .paignation button.active{
    background-color: rosybrown;

    }

    </style>
</head>
<body>

  <header class="header">
    <a href="#" class="logo"><img src="logo.png" alt="NEXUS Logo"> <strong>NEXUS</strong>Wellness</a>
    <nav class="navbar">
        <a href="#Home">Home</a>
        <a href="#About">About</a>
        <a href="#Services">Services</a>
        <a href="#Appointment">Appointment</a>
        <a href="#Review">Review</a>
        <a href="#Blogs">Blogs</a>
    </nav>
    <div id="menu-btn" class="fas fa-bars"></div>
</header>
<main>

   <div class="search-container">
        <div class="location-search">
            <div class="input-wrapper">
                <input id="stateInput" type="text" placeholder="Enter State" class="input-field" autocomplete="off" name="statefield">
                <div class="suggestions" id="suggestions1"></div>
                
            </div>
            <div class="input-wrapper">
                <input id="districtInput" type="text" placeholder="Enter District" class="input-field" autocomplete="off" name="distfield">
                <div class="suggestions" id="suggestions2"></div>
               
               
            </div>
            <div class = "feedbackloc"></div>
            <button id="locationSubmitButton" class="button" type="button">Submit</button>
        </div>
        <div class="treatment-search">
            <div class="input-wrapper">
                <input id="treatmentInput" type="text" placeholder="Search for treatments..." class="input-field" name="treatfield">
                <div class="suggestions" id="suggestions3"></div>
                
            </div>
            <div class = "feedbacktreat"></div>
            <button id="treatmentSubmitButton" class="button" type="submit">Search</button>
        </div>
    </div>






 <div class="searchresults">
    <p>Serach results </p>
    <div class = "table">
        <table>
            <thead>
                <tr>
                    <th>NAME OF HOSPITAL</th>
                    <th>ADDRESS</th>
                    <th>PRICE</th>
                    <th>PHONE NUMBER</th>
                </tr>
                <tbody class = "tabledata">

                </tbody>

            </thead>
        </table>
        <br>
        <br>
        <br>
        <div class = "paignation">
            

        </div>

    </div>
   </div>

</main>


<section class="footer">
    <div class="footer-container">
        <div class="footer-box">
            <h3>Quick Links</h3>
            <a href="Home"><i class="fas fa-chevron-right"></i>Home</a>
            <a href="About"><i class="fas fa-chevron-right"></i>About Us</a>
            <a href="Services"> <i class="fas fa-chevron-right"></i>Services</a>
            <a href="Appointment"><i class="fas fa-chevron-right"></i>Appointment</a>
            <a href="Reviews"><i class="fas fa-chevron-right"></i>Reviews</a>
            <a href="Blogs"><i class="fas fa-chevron-right"></i>Blogs</a>
        </div>
        <div class="footer-box">
            <h3>About Us</h3>
            <p>We are a wellness center dedicated to providing top-notch healthcare services to our clients. Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
        </div>
        <div class="footer-box">
            <h3>Follow Us</h3>
            <a href="#"><i class="fab fa-facebook-f"></i> Facebook</a>
            <a href="#"><i class="fab fa-twitter"></i> Twitter</a>
            <a href="#"><i class="fab fa-instagram"></i> Instagram</a>
            <a href="#"><i class="fab fa-linkedin"></i> LinkedIn</a>
        </div>
        <div class="footer-box">
            <h3>Contact Us</h3>
            <p>123 Street, City, Country</p>
            <p>Email: info@example.com</p>
            <p>Phone: +1234567890</p>
        </div>
    </div>
    <div class="footer-credit">Â© 2024 My Website. All Rights Reserved.</div>
</section>

<script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
<script>
   

    document.getElementById('treatmentSubmitButton').addEventListener('click', function() {
        var treatment = document.getElementById('treatmentInput').value;

     
    });

    $("#stateInput").on('input',function(e){
        console.log("helo thre");
        
      var keyword = $(this).val();
      console.log(keyword);
      if(keyword.length>0){
      $.ajax({
        type:"GET",
        url:"http://localhost:3000/testing",
        data:{action : "state",word : keyword},
        success:function(data){
            var string = "";
            var totallen = 5;
            if(data['state'].length>totallen) totallen = totallen;
            else totallen = data['state'].length;
           for(var i = 0;i<totallen;i++){
               string = string +`<div class = "suggestion">${data['state'][i]}</div>`

           }
           if(string === "") $('.suggestions').hide();
           else
           $('#suggestions1').html(string).show();
            
        },
        error:function()
        {  console.log('hello there');
            $('#suggestions1').html("sorry we havent there yet").show();

        },
        fail:function(){
            console.log('im sorry');
        }
      });
    }
    else  $('#suggestions1').hide();

    });


    $("#districtInput").on('input',function(e){
        console.log("helo thre");
        var statevalue = $('#stateInput').val();
        
      var keyword = $(this).val();
      console.log(keyword);
      if(keyword.length>0){
      $.ajax({
        type:"GET",
        url:"http://localhost:3000/testing",
        data:{action : "district",state : statevalue,word : keyword},
        success:function(data){
            var string = "";
            var totallen = 5;
            if(data['state'].length>totallen) totallen = totallen;
            else totallen = data['state'].length;
           for(var i = 0;i<totallen;i++){
               string = string +`<div class = "suggestion">${data['state'][i]}</div>`

           }
           if(string === "") $('.suggestions').hide();
           else
           $('#suggestions2').html(string).show();
            
        },
        error:function()
        {  console.log('hello there');
            $('#suggestions2').html("sorry we havent there yet").show();

        },
        fail:function(){
            console.log('im sorry');
        }
      });
    }
    else  $('#suggestions2').hide();

    });

    $("#suggestions1").on('click',function(e){
        var result = e.target;
        var string = result.textContent; 
        $("#stateInput").val(string);
        $('.suggestions').hide();

    });

    $("#suggestions2").on('click',function(e){
        var result = e.target;
        var string = result.textContent; 
        $("#districtInput").val(string);
        $('.suggestions').hide();

    });

  $('#locationSubmitButton').on('click',function(e){
    var statekey = $('#stateInput').val().toLowerCase();
    var districtkey = $('#districtInput').val().toLowerCase();


    $.ajax({
        type:"GET",
        url :"http://localhost:3000/search",
        data :{state : statekey,district : districtkey},
        success:function(data){
            console.log('succes');
            var feedState = data['data'][0];
            var feedDist = data['data'][1];
            if(feedState === 0){
                $('.feedbackloc').text("enterd state is not found").show();

            }
            else if(feedDist === 0){
                $('.feedbackloc').text("entered district is not found").show();
            }

            else{
                $('.feedbackloc').hide();
                $('.location-search').hide();
                $('.treatment-search').show();
            }

        },
        fail:function(){
            $('.feedbackloc').text("couldnt fetch request").show();
        },
        error:function(){
            $('.feedbackloc').text("couldnt fetch request").show();
        }

    })
});

$('#treatmentInput').on('input',function(e){

var keyword = $(this).val();
      console.log(keyword);
      if(keyword.length>0){
      $.ajax({
        type:"GET",
        url:"http://localhost:3000/testnames",
        data:{ testname : keyword},
        success:function(data){
            var string = "";
            var totallen = 5;
            if(data['state'].length>totallen) totallen = totallen;
            else totallen = data['state'].length;
           for(var i = 0;i<totallen;i++){
               string = string +`<div class = "suggestion">${data['state'][i]}</div>`

           }
           if(string === "") $('.suggestions').hide();
           else
           $('#suggestions3').html(string).show();
            
        },
        error:function()
        {  console.log('hello there');
            $('#suggestions3').html("sorry we havent there yet").show();

        },
        fail:function(){
            console.log('im sorry');
        }
      });
    }
    else  $('#suggestions3').hide();

});

$("#suggestions3").on('click',function(e){
        var result = e.target;
        var string = result.textContent; 
        $("#treatmentInput").val(string);
        $('.suggestions').hide();

    });

   
    let currentpage = 1;
    let totalpages;
    let rowsperpage = 20;
    let data;

    let lastpagerows;

    $("#treatmentSubmitButton").on("click",function(e){
        var treatinput = $("#treatmentInput").val().toLowerCase();
        var statekey = $('#stateInput').val().toUpperCase();
         var districtkey = $('#districtInput').val().toUpperCase();
         $.ajax({
            type:"GET",
            url:"http://localhost:3000/dashboard/getrates",
            data :{State:statekey,District:districtkey,treate:treatinput},
            success:function(hosdata){
                if(hosdata.length>0){
                $(".search-container").hide();
                $('.searchresults').show();
                data = hosdata;
     
                lastpagerows = (hosdata.length)%rowsperpage;
                totalpages = Math.ceil(hosdata.length/rowsperpage);
                rendertable();
                renderpaignation();
                }

                else $(".feedbacktreat").html('no hospitals were found').show();
                   

                

            },
            error:function(){
                console.log('something went wrong')
            },
            fail:function(){
                console.log("failed to fetch data");
            }


         })


        
    }
        

    );


    function rendertable(){
        let startindex = (currentpage -1)*rowsperpage;
        let endindex = startindex+rowsperpage;
        var treatinput = $("#treatmentInput").val().toLowerCase();
        if(currentpage == totalpages) endindex = startindex+ lastpagerows;
        var con = '';
        for(var i = startindex;i<endindex;i++){
            console.log(data.length);
            console.log('heelo there',currentpage);
                
                    con = con + `
                    <tr>
                        <td>${data[i]["Name of Hospital"]}</td>
                        <td>${data[i]["Address"]}</td>
                        <td>${data[i][treatinput]}</td>
                        <td>${data[i]["Mitra Contact No"]}</td>

                    </tr>`;


              
        }
        $('.tabledata').html(con);
    }

    function renderpaignation(){
        $(".paignation").html('');
           let startpage = Math.max(1, currentpage - 2);
            let endpage = Math.min(totalpages, startpage + 4);
            if(startpage>1){
                console.log('hello therer in paigna')

                
                let  newButton = $('<button>', {
                    type:'button',
                    text: 'prev',
 
                      
                    click: function() {
                        currentpage = currentpage-1;
                    rendertable();
                    renderpaignation();
                       }
                    });




                
                $(".paignation").append(newButton);


            }

            for(let i = startpage;i<=endpage;i++){

                console.log('hello therer in paigna middle')
                let newButton = $('<button>', {
                    type:'button',
                    text: i,
 
                      
                    click: function(e) {
                        let value = parseInt($(this).text());
                        
                        currentpage = value;
                    rendertable();
                    renderpaignation();
                       }
                    });

                if(i == currentpage) newButton.addClass('active');
                $(".paignation").append(newButton);
              }

              if(endpage<totalpages){

                let newButton = $('<button>', {
                    type:'button',
                    text: 'next',
 
                      
                    click: function() {
                    currentpage = currentpage+1;
                    rendertable();
                    renderpaignation();
                       }
                    });

                
                $(".paignation").append(newButton);


              }

    }


    



</script>
</body>
</html>